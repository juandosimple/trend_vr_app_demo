<!-- results.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/dashboard.css">
</head>
<!-- Firebase App (the core Firebase SDK) -->
<script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>

<!-- Add Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-storage.js"></script>

<script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyCtZxlonTfLpU_5-HMuf6RdDmbJy3iMdPU",
        authDomain: "trend-vr-demo.firebaseapp.com",
        projectId: "trend-vr-demo",
        storageBucket: "trend-vr-demo.appspot.com",
        messagingSenderId: "383550694303",
        appId: "1:383550694303:web:362cf770089f4008e4d3aa"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
</script>

<body>



  <div class="logo-header">
  <img src="./assets/images/logo-white.png" class="logo">
  <a href="#" class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">Menu</a>
  </div>
  <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
  <div class="offcanvas-header">
  <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Menu</h5>
  <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
  <ul>
    <li>
      <a href="./profile.html">Profile</a>
    </li>
    <li>
      <a href="#">Browse stores</a>
    </li>
    <li>
      <a href="#">Log out</a>
    </li>
  </ul>
  </div>
  </div>
  <div class="container">
    <div class="row justify-content-center vertical-centering" id="container2">
      <div class="col-12 wizard-container__content">

                <h1 class="title">Welcome!</h1>
                <h2 class="subtitle">To start upload a good picture of yourself so you can start browsing for clothing</h2>
                <div class="upload-container">
                    <form id="uploadForm" enctype="multipart/form-data">
                        <input type="file" name="file" id="fileUpload">
                        <button type="submit" class="btn btn-primary">Upload</button>
                    </form>
                </div>
                <div id="uploadSuccessMessage" class="alert alert-success">
                    ¡Uploaded succesfully!
                </div>
                <div class="wizard-footer">
                    <button class="btn btn-secondary" id="backButton2">Back</button>
                    <button class="btn btn-primary" id="nextButton3" disabled>Next Step</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

        <script>
            function generateID() {
              return 'id_' + Math.random().toString(36).substr(2, 9);
            }
          
            window.onload = function() {
              let userID = localStorage.getItem('userID');
              if (!userID) {
                userID = generateID();
                localStorage.setItem('userID', userID);
              }
              console.log('Current User ID:', userID); // Para propósitos de depuración
            };
          </script>
          
          <script>
            document.getElementById('uploadForm').addEventListener('submit', function(event) {
              event.preventDefault();
              var file = document.getElementById('fileUpload').files[0];
              var userID = localStorage.getItem('userID'); // Recupera el ID del usuario del Local Storage
              var storageRef = firebase.storage().ref('users/' + userID + '/' + file.name);
              var uploadTask = storageRef.put(file);
          
              uploadTask.on('state_changed', function(snapshot) {
                // Aquí puedes agregar un indicador de progreso basado en snapshot
              }, function(error) {
                console.error('Upload failed:', error);
                alert('Error during file upload: ' + error.message);
              }, function() {
                uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
                  console.log('File available at', downloadURL);
                  document.getElementById('uploadSuccessMessage').style.display = 'block';
                  document.getElementById('nextButton3').disabled = false;
                });
              });
            });
          </script>
          
          

</body>

</html>