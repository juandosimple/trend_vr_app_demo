<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/dashboard.css">
    <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>

    <style>
        #preloader {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #imageContainer{
            width: 100%;
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
        }
        #imageContainer img{
            max-width: 100%;
            width: 250px;
            margin:1rem 0;
            background: #fff;
    border-radius: 5px;
    padding: 1rem;
}

.title{
text-align: center;
    width: 100%;
    color: #fff;
}
.change-image{
    width: 100%;
    background: #252525;
    padding: 1rem;
    border-radius: 5px;
    color: #fff;
    text-decoration: none;
    text-align: center;
    margin: 1rem;
}
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-storage.js"></script>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyCtZxlonTfLpU_5-HMuf6RdDmbJy3iMdPU",
            authDomain: "trend-vr-demo.firebaseapp.com",
            projectId: "trend-vr-demo",
            storageBucket: "trend-vr-demo.appspot.com",
            messagingSenderId: "383550694303",
            appId: "1:383550694303:web:362cf770089f4008e4d3aa"
        };
        firebase.initializeApp(firebaseConfig);
        var storage = firebase.storage();

        function displayImages() {
            const userId = localStorage.getItem('userID');
            const listRef = storage.ref(`users/${userId}/`);
            listRef.listAll().then(function(res) {
                if (res.items.length === 0) {
                    document.getElementById('preloader').style.display = 'none';
                    document.getElementById('imageContainer').innerHTML = "<p>You don't have any generated images yet.</p>";
                } else {
                    res.items.forEach(function(imageRef) {
                        displayImage(imageRef);
                    });
                }
            }).catch(function(error) {
                console.log("Error fetching images:", error);
            });
        }

        function displayImage(imageRef) {
            imageRef.getDownloadURL().then(function(url) {
                var img = document.createElement('img');
                img.src = url;
                document.getElementById('imageContainer').appendChild(img);
            }).catch(function(error) {
                console.log("Error displaying image:", error);
            }).finally(function() {
                document.getElementById('preloader').style.display = 'none';
            });
        }

        window.onload = displayImages;
    </script>
</head>
<body>

    <div class="logo-header">
        <img src="./assets/images/logo-white.png" class="logo">
        <a href="#" class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">Menu</a>
    </div>
    <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
        <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
        <ul>
          <li>
            <a href="./profile.html">Profile</a>
          </li>
          <li>
            <a href="#">Browse stores</a>
          </li>
          <li>
            <a href="#">Log out</a>
          </li>
        </ul>
        </div>
        </div>
    <div class="container">
        <div class="row justify-content-center vertical-centering" id="container2">
            <div class="col-12 wizard-container__content">
                <h2 class="title">Your Profile image</h2>
                
                <div id="imageContainer">
                    <div id="preloader">
                        <dotlottie-player src="./assets/images/1715774396840.lottie" 
                        background="transparent" 
                        speed="1" 
                        style="width: 300px; height: 300px" direction="1" playMode="normal" 
                        loop 
                        autoplay
                        ></dotlottie-player>
                    </div>
                </div>

                <a href="#" class="change-image">Change profile image</a>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>
</html>
